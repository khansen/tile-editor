<?xml version="1.0"?>
<project name="TileManipulator" default="build">
    <!-- Define project properties -->
    <property name="src.dir" value="."/>
    <property name="build.dir" value="classes"/>
    <property name="dist.dir" value="dist"/>

    <target name="clean" description="remove intermediate files">
        <delete dir="${build.dir}"/>
        <delete dir="${dist.dir}"/>
        <delete file="tm.jar"/>
    </target>

    <target name="init">
        <mkdir dir="${build.dir}"/>
        <mkdir dir="${dist.dir}"/>
    </target>

    <target name="compile" depends="init" description="compile the Java source code to class files">
        <javac includeantruntime="false"
               srcdir="${src.dir}"
               destdir="${build.dir}"
               debug="true"
               encoding="UTF-8">
            <compilerarg value="-Xlint:unchecked"/>
        </javac>
    </target>

    <target name="jar" depends="compile" description="create a Jar file for the application">
        <jar destfile="${dist.dir}/tm.jar">
            <fileset dir="${build.dir}" includes="**/*.class"/>
            <fileset dir="${src.dir}">
                <include name="**/*.gif"/>
                <include name="**/*.png"/>
                <include name="**/*.properties"/>
                <include name="**/*.dtd"/>
                <include name="tmspec.xml"/>
            </fileset>
            <manifest>
                <attribute name="Main-Class" value="TileManipulator"/>
            </manifest>
        </jar>
    </target>

    <target name="build" depends="clean,jar" description="clean and build everything"/>

    <target name="run" depends="jar" description="run the application">
        <java jar="${dist.dir}/tm.jar" fork="true">
            <!-- Mac dock name and menu properties -->
            <jvmarg value="-Xdock:name=Tile Manipulator"/>
            <jvmarg value="-Dapple.awt.application.name=Tile Manipulator"/>
            <jvmarg value="-Dapple.laf.useScreenMenuBar=true"/>
            <jvmarg value="-Dcom.apple.mrj.application.apple.menu.about.name=Tile Manipulator"/>
            <!-- Mac dock icon -->
            <jvmarg value="-Xdock:icon=resources/tile-icon-512.png"/>
        </java>
    </target>
</project>
